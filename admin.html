<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>لوحة الإدارة - ANUBIS</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* نفس الستايل السابق مع بعض التعديلات */
    body { background: #0f0f0f; color: #eee; font-family: "Cairo", sans-serif; padding: 20px; text-align: center; }
    .admin-container { max-width: 900px; margin: auto; background: #1a1a1a; padding: 20px; border-radius: 15px; box-shadow: 0 0 25px rgba(0,0,0,0.5); }
    input, textarea { width: 90%; background: #222; color: #fff; border: 1px solid #333; border-radius: 8px; padding: 8px; margin: 5px 0; font-size: 14px; }
    button { background: #333; color: #fff; border: none; padding: 8px 14px; border-radius: 8px; cursor: pointer; margin: 3px; transition: 0.2s; }
    button:hover { background: #444; }
    h1 { font-size: 24px; margin-bottom: 15px; color: #f5b301; }
    .card { background: #191919; padding: 20px; border-radius: 12px; margin: 10px 0; box-shadow: 0 0 10px rgba(255,255,255,0.05); }
  </style>
</head>
<body>
  <h1>⚙️ لوحة إدارة ANUBIS</h1>

  <div id="loginScreen" class="admin-container">
    <p>يرجى إدخال بيانات الدخول للوصول إلى لوحة التحكم</p>
    <input type="text" id="loginUser" placeholder="اسم المستخدم" value="admin"><br>
    <input type="password" id="loginPass" placeholder="كلمة المرور"><br>
    <button id="btnLogin">دخول</button>
  </div>

  <div id="adminPanel" class="hidden admin-container">
    <div class="card">
      <h3>➕ إضافة بائع جديد</h3>
      <label>الدولة:</label><br>
      <input id="countryName" placeholder="اسم الدولة"><br>
      <label>اسم البائع:</label><br>
      <input id="sellerName" placeholder="اسم البائع"><br>
      <label>الوصف:</label><br>
      <textarea id="sellerDesc" placeholder="وصف البائع"></textarea><br>
      <label>رابط تيليجرام:</label><br>
      <input id="telegram" placeholder="https://t.me/username"><br>
      <label>رابط واتساب:</label><br>
      <input id="whatsapp" placeholder="https://wa.me/number"><br>
      <label><input type="checkbox" id="verified"> بائع موثّق ✅</label><br>
      <button id="btnAddSeller">إضافة البائع</button>
    </div>

    <div class="card">
      <h3>➕ إضافة منتج جديد</h3>
      <input id="prodName" placeholder="اسم المنتج"><br>
      <input id="prodPrice" placeholder="السعر"><br>
      <input id="prodImage" placeholder="رابط صورة المنتج (URL)"><br>
      <textarea id="prodDetails" placeholder="تفاصيل المنتج"></textarea><br>
      <button id="btnAddProduct">إضافة المنتج</button>
    </div>

    <div class="card">
      <h3>📋 القوائم</h3>
      <div id="sellersTable"></div>
      <hr>
      <div id="productsTable"></div>
    </div>

    <button onclick="logout()">تسجيل خروج</button>
  </div>

  <script>
    const api = '/api';

    document.getElementById('btnLogin').onclick = async () => {
      const username = document.getElementById('loginUser').value;
      const password = document.getElementById('loginPass').value;
      try {
        const res = await fetch(api + '/admin/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ username, password })
        });
        const j = await res.json();
        if (j.success) {
          localStorage.setItem('anubis_admin_token', j.token);
          document.getElementById('loginScreen').classList.add('hidden');
          document.getElementById('adminPanel').classList.remove('hidden');
          loadTables();
        } else {
          alert(j.error || 'خطأ في الدخول');
        }
      } catch (e) { alert('خطأ في الاتصال بالسيرفر'); }
    };

    async function loadTables() {
      // sellers
      const sRes = await fetch(api + '/sellers');
      const sellers = await sRes.json();
      const sellersTable = document.getElementById('sellersTable');
      sellersTable.innerHTML = '<h4>البائعين</h4>';
      sellers.forEach(s => {
        const div = document.createElement('div');
        div.className = 'seller-row';
        div.innerHTML = `<strong>${s.country}</strong> - ${s.name} ${s.verified ? '✅' : ''} | شكاوى: ${s.complaints || 0}
          <button onclick="deleteSeller(${s.id})">حذف</button>`;
        sellersTable.appendChild(div);
      });

      // products
      const pRes = await fetch(api + '/products');
      const products = await pRes.json();
      const productsTable = document.getElementById('productsTable');
      productsTable.innerHTML = '<h4>المنتجات</h4>';
      products.forEach(p => {
        const div = document.createElement('div');
        div.className = 'seller-row';
        div.innerHTML = `<strong>${p.name}</strong> | ${p.price} <br>
          ${p.details || ''} <br>
          <img src="${p.image || ''}" style="max-width:80px; display:block; margin:6px 0;" />
          <button onclick="deleteProduct(${p.id})">حذف</button>`;
        productsTable.appendChild(div);
      });
    }

    document.getElementById('btnAddSeller').onclick = async () => {
      const payload = {
        country: document.getElementById('countryName').value.trim(),
        name: document.getElementById('sellerName').value.trim(),
        desc: document.getElementById('sellerDesc').value.trim(),
        telegram: document.getElementById('telegram').value.trim(),
        whatsapp: document.getElementById('whatsapp').value.trim(),
        verified: document.getElementById('verified').checked
      };
      const res = await fetch(api + '/seller', { method: 'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
      const j = await res.json();
      if (j.success) {
        alert('تم إضافة البائع');
        loadTables();
      } else alert('خطأ');
    };

    document.getElementById('btnAddProduct').onclick = async () => {
      const payload = {
        name: document.getElementById('prodName').value.trim(),
        price: document.getElementById('prodPrice').value.trim(),
        image: document.getElementById('prodImage').value.trim(),
        details: document.getElementById('prodDetails').value.trim()
      };
      const res = await fetch(api + '/product', { method: 'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
      const j = await res.json();
      if (j.success) {
        alert('تم إضافة المنتج');
        loadTables();
      } else alert('خطأ في الإضافة');
    };

    async function deleteSeller(id) {
      if (!confirm('هل أنت متأكد؟')) return;
      await fetch(api + '/seller/' + id, { method: 'DELETE' });
      loadTables();
    }
    async function deleteProduct(id) {
      if (!confirm('هل أنت متأكد؟')) return;
      await fetch(api + '/product/' + id, { method: 'DELETE' });
      loadTables();
    }

    function logout() {
      localStorage.removeItem('anubis_admin_token');
      document.getElementById('adminPanel').classList.ad

