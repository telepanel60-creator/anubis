<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© - ANUBIS</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Ù†ÙØ³ Ø§Ù„Ø³ØªØ§ÙŠÙ„ Ø§Ù„Ø³Ø§Ø¨Ù‚ Ù…Ø¹ Ø¨Ø¹Ø¶ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª */
    body { background: #0f0f0f; color: #eee; font-family: "Cairo", sans-serif; padding: 20px; text-align: center; }
    .admin-container { max-width: 900px; margin: auto; background: #1a1a1a; padding: 20px; border-radius: 15px; box-shadow: 0 0 25px rgba(0,0,0,0.5); }
    input, textarea { width: 90%; background: #222; color: #fff; border: 1px solid #333; border-radius: 8px; padding: 8px; margin: 5px 0; font-size: 14px; }
    button { background: #333; color: #fff; border: none; padding: 8px 14px; border-radius: 8px; cursor: pointer; margin: 3px; transition: 0.2s; }
    button:hover { background: #444; }
    h1 { font-size: 24px; margin-bottom: 15px; color: #f5b301; }
    .card { background: #191919; padding: 20px; border-radius: 12px; margin: 10px 0; box-shadow: 0 0 10px rgba(255,255,255,0.05); }
  </style>
</head>
<body>
  <h1>âš™ï¸ Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø© ANUBIS</h1>

  <div id="loginScreen" class="admin-container">
    <p>ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</p>
    <input type="text" id="loginUser" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…" value="admin"><br>
    <input type="password" id="loginPass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"><br>
    <button id="btnLogin">Ø¯Ø®ÙˆÙ„</button>
  </div>

  <div id="adminPanel" class="hidden admin-container">
    <div class="card">
      <h3>â• Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ø¦Ø¹ Ø¬Ø¯ÙŠØ¯</h3>
      <label>Ø§Ù„Ø¯ÙˆÙ„Ø©:</label><br>
      <input id="countryName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¯ÙˆÙ„Ø©"><br>
      <label>Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø¦Ø¹:</label><br>
      <input id="sellerName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø¨Ø§Ø¦Ø¹"><br>
      <label>Ø§Ù„ÙˆØµÙ:</label><br>
      <textarea id="sellerDesc" placeholder="ÙˆØµÙ Ø§Ù„Ø¨Ø§Ø¦Ø¹"></textarea><br>
      <label>Ø±Ø§Ø¨Ø· ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…:</label><br>
      <input id="telegram" placeholder="https://t.me/username"><br>
      <label>Ø±Ø§Ø¨Ø· ÙˆØ§ØªØ³Ø§Ø¨:</label><br>
      <input id="whatsapp" placeholder="https://wa.me/number"><br>
      <label><input type="checkbox" id="verified"> Ø¨Ø§Ø¦Ø¹ Ù…ÙˆØ«Ù‘Ù‚ âœ…</label><br>
      <button id="btnAddSeller">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø§Ø¦Ø¹</button>
    </div>

    <div class="card">
      <h3>â• Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ø¬Ø¯ÙŠØ¯</h3>
      <input id="prodName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬"><br>
      <input id="prodPrice" placeholder="Ø§Ù„Ø³Ø¹Ø±"><br>
      <input id="prodImage" placeholder="Ø±Ø§Ø¨Ø· ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬ (URL)"><br>
      <textarea id="prodDetails" placeholder="ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬"></textarea><br>
      <button id="btnAddProduct">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬</button>
    </div>

    <div class="card">
      <h3>ğŸ“‹ Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…</h3>
      <div id="sellersTable"></div>
      <hr>
      <div id="productsTable"></div>
    </div>

    <button onclick="logout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
  </div>

  <script>
    const api = '/api';

    document.getElementById('btnLogin').onclick = async () => {
      const username = document.getElementById('loginUser').value;
      const password = document.getElementById('loginPass').value;
      try {
        const res = await fetch(api + '/admin/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ username, password })
        });
        const j = await res.json();
        if (j.success) {
          localStorage.setItem('anubis_admin_token', j.token);
          document.getElementById('loginScreen').classList.add('hidden');
          document.getElementById('adminPanel').classList.remove('hidden');
          loadTables();
        } else {
          alert(j.error || 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„');
        }
      } catch (e) { alert('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±'); }
    };

    async function loadTables() {
      // sellers
      const sRes = await fetch(api + '/sellers');
      const sellers = await sRes.json();
      const sellersTable = document.getElementById('sellersTable');
      sellersTable.innerHTML = '<h4>Ø§Ù„Ø¨Ø§Ø¦Ø¹ÙŠÙ†</h4>';
      sellers.forEach(s => {
        const div = document.createElement('div');
        div.className = 'seller-row';
        div.innerHTML = `<strong>${s.country}</strong> - ${s.name} ${s.verified ? 'âœ…' : ''} | Ø´ÙƒØ§ÙˆÙ‰: ${s.complaints || 0}
          <button onclick="deleteSeller(${s.id})">Ø­Ø°Ù</button>`;
        sellersTable.appendChild(div);
      });

      // products
      const pRes = await fetch(api + '/products');
      const products = await pRes.json();
      const productsTable = document.getElementById('productsTable');
      productsTable.innerHTML = '<h4>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h4>';
      products.forEach(p => {
        const div = document.createElement('div');
        div.className = 'seller-row';
        div.innerHTML = `<strong>${p.name}</strong> | ${p.price} <br>
          ${p.details || ''} <br>
          <img src="${p.image || ''}" style="max-width:80px; display:block; margin:6px 0;" />
          <button onclick="deleteProduct(${p.id})">Ø­Ø°Ù</button>`;
        productsTable.appendChild(div);
      });
    }

    document.getElementById('btnAddSeller').onclick = async () => {
      const payload = {
        country: document.getElementById('countryName').value.trim(),
        name: document.getElementById('sellerName').value.trim(),
        desc: document.getElementById('sellerDesc').value.trim(),
        telegram: document.getElementById('telegram').value.trim(),
        whatsapp: document.getElementById('whatsapp').value.trim(),
        verified: document.getElementById('verified').checked
      };
      const res = await fetch(api + '/seller', { method: 'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
      const j = await res.json();
      if (j.success) {
        alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨Ø§Ø¦Ø¹');
        loadTables();
      } else alert('Ø®Ø·Ø£');
    };

    document.getElementById('btnAddProduct').onclick = async () => {
      const payload = {
        name: document.getElementById('prodName').value.trim(),
        price: document.getElementById('prodPrice').value.trim(),
        image: document.getElementById('prodImage').value.trim(),
        details: document.getElementById('prodDetails').value.trim()
      };
      const res = await fetch(api + '/product', { method: 'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify(payload)});
      const j = await res.json();
      if (j.success) {
        alert('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬');
        loadTables();
      } else alert('Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø¥Ø¶Ø§ÙØ©');
    };

    async function deleteSeller(id) {
      if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ')) return;
      await fetch(api + '/seller/' + id, { method: 'DELETE' });
      loadTables();
    }
    async function deleteProduct(id) {
      if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ')) return;
      await fetch(api + '/product/' + id, { method: 'DELETE' });
      loadTables();
    }

    function logout() {
      localStorage.removeItem('anubis_admin_token');
      document.getElementById('adminPanel').classList.ad

